<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>GreenForce CRM</title>
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#10B981', // Emerald green
            secondary: '#059669',
          }
        }
      }
    }
  </script>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body class="bg-gray-50 text-gray-800 dark:bg-gray-900 dark:text-gray-200 transition-colors duration-200">
  <!-- Main Layout -->
  <div class="flex h-screen overflow-hidden">
    <!-- Sidebar -->
    <aside id="sidebar" class="w-64 bg-white dark:bg-gray-800 shadow-md fixed md:static h-full z-20 transform -translate-x-full md:translate-x-0 transition-transform duration-300">
      <div class="p-4 border-b border-gray-200 dark:border-gray-700">
        <h1 class="text-2xl font-bold text-primary">GreenForce CRM</h1>
      </div>
      <nav class="p-4 space-y-2">
        <a href="#" class="block py-2 px-4 rounded hover:bg-gray-100 dark:hover:bg-gray-700 active-link" data-page="dashboard">ğŸ“Š Dashboard</a>
        <a href="#" class="block py-2 px-4 rounded hover:bg-gray-100 dark:hover:bg-gray-700" data-page="customers">ğŸ‘¥ Customers</a>
        <a href="#" class="block py-2 px-4 rounded hover:bg-gray-100 dark:hover:bg-gray-700" data-page="inventory">ğŸ“¦ Inventory</a>
        <a href="#" class="block py-2 px-4 rounded hover:bg-gray-100 dark:hover:bg-gray-700" data-page="sales">ğŸ’° Sales</a>
        <a href="#" class="block py-2 px-4 rounded hover:bg-gray-100 dark:hover:bg-gray-700" data-page="repairs">ğŸ”§ Repairs</a>
        <a href="#" class="block py-2 px-4 rounded hover:bg-gray-100 dark:hover:bg-gray-700" data-page="delivery">ğŸšš Delivery</a>
        <a href="#" class="block py-2 px-4 rounded hover:bg-gray-100 dark:hover:bg-gray-700" data-page="settings">âš™ï¸ Settings</a>
      </nav>
    </aside>

    <!-- Main Content -->
    <div class="flex-1 flex flex-col overflow-hidden">
      <!-- Topbar -->
      <header class="bg-white dark:bg-gray-800 shadow-sm p-4 flex justify-between items-center">
        <button id="menu-toggle" class="md:hidden text-gray-600 dark:text-gray-300">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
          </svg>
        </button>
        <div class="flex items-center space-x-4">
          <button id="theme-toggle" class="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700">
            <svg id="theme-icon" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
            </svg>
          </button>
          <div class="flex items-center space-x-2">
            <span id="user-role-badge" class="px-2 py-1 text-xs font-semibold rounded-full bg-primary text-white"></span>
            <span id="user-name" class="font-medium">Admin</span>
          </div>
        </div>
      </header>

      <!-- Page Content -->
      <main id="page-content" class="flex-1 overflow-y-auto p-4 bg-gray-50 dark:bg-gray-900">
        <!-- Pages will be loaded here via JS -->
      </main>
    </div>
  </div>

  <!-- Modals -->
  <div id="modal-root"></div>

  <!-- Scripts -->
  <script src="js/auth.js"></script>
  <script src="js/utils.js"></script>
  <script src="js/dashboard.js"></script>
  <script src="js/customers.js"></script>
  <script src="js/inventory.js"></script>
  <script src="js/sales.js"></script>
  <script src="js/repairs.js"></script>
  <script src="js/delivery.js"></script>

  <script>
  // Page routing
  document.querySelectorAll('nav a[data-page]').forEach(link => {
    link.addEventListener('click', function(e) {
      e.preventDefault();
      
      // Remove active class from all
      document.querySelectorAll('nav a').forEach(a => a.classList.remove('active-link'));
      // Add to clicked
      this.classList.add('active-link');

      const page = this.dataset.page;

      // Load the correct page
      switch(page) {
        case 'dashboard': loadDashboard(); break;
        case 'customers': loadCustomersPage(); break;
        case 'inventory': loadInventoryPage(); break;
        case 'sales': loadSalesPage(); break;
        case 'repairs': loadRepairsPage(); break;
        case 'delivery': loadDeliveryPage(); break;
        case 'settings':
          document.getElementById('page-content').innerHTML = `
            <h2 class="text-2xl font-bold">Settings</h2>
            <p class="mt-4">User Role: <span class="font-semibold">${currentUser.role}</span></p>
            <button onclick="toggleRole()" class="mt-4 bg-primary text-white px-4 py-2 rounded">ğŸ”„ Switch Role (Demo)</button>
          `;
          break;
        default: loadDashboard();
      }
    });
  });

  // Optional: Role switcher for demo
  function toggleRole() {
    const roles = ['admin', 'sales', 'technician', 'inventory'];
    const current = currentUser.role;
    const next = roles[(roles.indexOf(current) + 1) % roles.length];
    currentUser.role = next;
    currentUser.name = next.charAt(0).toUpperCase() + next.slice(1) + ' User';
    
    // Update UI
    document.getElementById('user-role-badge').textContent = currentUser.role.charAt(0).toUpperCase() + currentUser.role.slice(1);
    document.getElementById('user-name').textContent = currentUser.name;
    
    // Re-apply permissions
    applyRolePermissions();
    
    // Reload current page
    const activePage = document.querySelector('nav a.active-link')?.dataset.page || 'dashboard';
    const event = new Event('click');
    document.querySelector(`nav a[data-page="${activePage}"]`)?.dispatchEvent(event);
  }

  // Initial load: show dashboard
  document.querySelector('nav a[data-page="dashboard"]').click();
</script>
</body>
</html>